@model ChatOnYourDataModel
@{
    ViewData["Title"] = "Chat On Your Data";
}

<!-- Start Content-->
<div class="container-fluid">
    
    <!-- start page title -->
    <div class="row">
        <div class="col-12">
            <div class="page-title-box">
                <div class="page-title-right">
                    <ol class="breadcrumb m-0">
                        <li class="breadcrumb-item">Services</li>
                        <li class="breadcrumb-item active">Chat On Your Data</li>
                    </ol>
                </div>
                <h4 class="page-title">Chat On Your Data</h4>
            </div>
        </div>
    </div>

    <div class="row" id="showresult">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-body">
                    @if (Model.DefaultQuestions != null && Model.DefaultQuestions.Any())
                    {
                        <div class="row mb-3">
                            <div class="col-12">
                                <h5 class="card-title">Suggested Questions</h5>
                                <p class="text-muted">Try these sample questions to get started with your document analysis:</p>
                                <div class="row">
                                    @foreach (var question in Model.DefaultQuestions)
                                    {
                                        <div class="col-lg-6 col-md-12 mb-2">
                                            <div class="card border-light">
                                                <div class="card-body p-3">
                                                    <button type="button" class="btn btn-outline-primary btn-sm w-100 text-start question-btn" 
                                                            data-question="@question">
                                                        <i class="mdi mdi-chat-question me-1"></i>
                                                        @question
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    }

                    <div id="chat-frame" class="ratio ratio-16x9">
                        <iframe id="bigframe" src="@Model.Link" frameborder="0"></iframe>
                    </div>

                </div>
            </div> 
        </div>
    </div>
 

</div>
<!-- container -->

<style>
.question-btn {
    text-align: left !important;
    white-space: normal;
    height: auto;
    padding: 10px 15px;
    transition: all 0.2s ease;
}

.question-btn:hover {
    background-color: #0d6efd;
    border-color: #0d6efd;
    color: white;
}

.question-btn.active {
    background-color: #0d6efd;
    border-color: #0d6efd;
    color: white;
}

.question-btn i {
    margin-right: 8px;
}
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const questionButtons = document.querySelectorAll('.question-btn');
        const iframe = document.getElementById('bigframe');
        
        questionButtons.forEach(button => {
            button.addEventListener('click', function() {
                const question = this.getAttribute('data-question');
                
                // Try to send the question to the iframe via postMessage
                if (iframe && iframe.contentWindow) {
                    try {
                        iframe.contentWindow.postMessage({
                            type: 'set_question',
                            question: question
                        }, '*');
                    } catch (error) {
                        console.log('Could not send question to iframe:', error);
                    }
                }
                
                // Visual feedback - highlight the clicked button
                questionButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
            });
        });
    });
</script>